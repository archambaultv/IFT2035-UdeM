\begin{Exercise}[title={Macro case}]
Soit une macro \codeinline{case} en Scheme qui peut s'utiliser comme suit:
\begin{minted}{scheme}
  (case <exp>
    ((1 3 5) <exp1>)
    ((4) <exp2>)
    (else <exp3>))
\end{minted}
qui signifierait exécuter \codeinline{exp1} si \codeinline{exp} vaut 1, 3, ou 5;
exécuter \codeinline{exp2} si \codeinline{exp} vaut 4 et exécuter \codeinline{exp3} sinon.

\begin{itemize}
\item Écrire une définition (naïve) de cette macro en Scheme avec
  \codeinline{define-macro}.

\item Discuter des différents problèmes qui peuvent apparaître lors de
  l'usage de cette macro dûs à son implémantation naïve.  Montrer des
  exemples concrets d'usage où la macro ne fait pas ce que le
  programmeur attendait.

\item Écrire une implémentation plus rafinée qui fait très attention à ce
  que le code donne une sémantique propre, sans mauvaises surprises pour
  l'utilisateur de cette macro.
\end{itemize}
\end{Exercise}