\begin{Exercise}
\label{ex:implantation_portee}
Vous devez implanter deux évaluateurs pour un langage minimaliste. L'un aura la
portée lexicale et l'autre la portée dynamique. Les expressions du langage
peuvent être décrites avec le datatype \codeinline{Exp}.
\haskellinput[firstline=1,lastline=5]{exercices/implantation_portée_solution.hs}

Dans les deux cas, l'évaluation d'une expression
\codeinline{App e1 e2} doit réduire
\codeinline{e1} à une valeur de type fonction sinon
l'évaluation ne peut plus se poursuivre.

Pour vous aider, l'évaluateur avec portée dynamique
a un environnement, des valeurs et une signature définie comme suit:
\haskellinput[firstline=7,lastline=12]{exercices/implantation_portée_solution.hs}

L'évaluateur avec portée lexicale possède le même environnement mais a
des valeurs et une signature définie comme suit:
\haskellinput[firstline=32,lastline=35]{exercices/implantation_portée_solution.hs}
\end{Exercise}

\begin{Answer}[ref={ex:implantation_portee}]
  \haskellinput{exercices/implantation_portée_solution.hs}
\end{Answer}